<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‚ú® ÂÖ´Â≠óËÉΩÈáèÂàÜÊûêÂÑÄ ‚ú®</title>
    <!-- ÂºïÂÖ• Lunar.js (ÊéíÁõ§Â∫´) -->
    <script src="https://cdn.jsdelivr.net/npm/lunar-javascript@1.2.37/lunar.js"></script>
    <!-- ÂºïÂÖ• Chart.js (Èõ∑ÈÅîÂúñÁî®) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- ÂºïÂÖ•Â≠óÂûã -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&family=Zcool+KuaiLe&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #FF6B6B;
            --secondary-color: #4ECDC4;
            --accent-color: #FFE66D;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-main: #2C3E50;
        }

        body { 
            margin: 0; 
            overflow: hidden; 
            background: radial-gradient(circle at center, #2E2157 0%, #050508 100%);
            font-family: 'Nunito', 'Microsoft JhengHei', sans-serif;
            color: white;
        }
        
        /* === UI ÊéßÂà∂Èù¢ÊùøÂ§ñÂ±§ÂÆπÂô® === */
        #ui-wrapper {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            display: flex;
            align-items: flex-start;
            transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            width: auto; 
        }

        #ui-wrapper.collapsed {
            transform: translateX(calc(-100% + 40px));
        }

        /* === ÂÖßÂÆπÂçÄÂ°ä === */
        #ui-container {
            width: 280px;
            max-height: 85vh; 
            overflow-y: auto;
            padding: 20px;
            
            background: var(--card-bg);
            border-radius: 25px;
            border: 3px solid rgba(255,255,255,0.8);
            backdrop-filter: blur(12px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            color: var(--text-main);
            box-sizing: border-box;
            
            scrollbar-width: none; 
            -ms-overflow-style: none;
        }
        #ui-container::-webkit-scrollbar { display: none; }

        /* === Èö±Ëóè/È°ØÁ§∫ÊåâÈàï === */
        .toggle-panel-btn {
            width: 40px;
            height: 40px;
            background: #fff;
            border-radius: 0 12px 12px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 4px 0 10px rgba(0,0,0,0.1);
            font-size: 1.2rem;
            color: var(--text-main);
            margin-top: 20px; 
            transition: background 0.2s;
            z-index: 11;
            flex-shrink: 0;
        }
        .toggle-panel-btn:hover { background: #f0f0f0; }

        h1 { 
            margin: 0 0 15px 0; 
            font-size: 1.3rem; 
            color: #FF6B6B; 
            text-align: center;
            font-weight: 900; 
            letter-spacing: 1px;
            text-shadow: 2px 2px 0px #ffe66d;
        }

        .input-group label { display: block; font-size: 0.85rem; color: #666; margin-bottom: 5px; font-weight: 700; }
        
        input[type="datetime-local"] {
            width: 100%;
            background: #f0f3f8;
            border: 2px solid #e0e0e0;
            color: #333;
            padding: 10px;
            border-radius: 15px;
            font-family: inherit;
            box-sizing: border-box;
            font-size: 0.9rem;
            outline: none;
            transition: 0.3s;
        }
        input[type="datetime-local"]:focus { border-color: var(--secondary-color); background: #fff; }

        .gender-group { display: flex; gap: 10px; margin-bottom: 15px; margin-top: 10px; }
        .gender-option { flex: 1; }
        .gender-radio { display: none; }
        .gender-label {
            display: block; text-align: center; padding: 8px;
            background: #eee; border: 2px solid transparent;
            border-radius: 15px; cursor: pointer; font-size: 0.9rem; color: #888;
            transition: all 0.2s; font-weight: bold;
        }
        .gender-radio:checked + .gender-label { background: var(--secondary-color); color: #fff; transform: scale(1.05); box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4); }
        #gender-f:checked + .gender-label { background: #FF6B6B; box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4); }

        button.action-btn {
            width: 100%;
            background: linear-gradient(45deg, #4ECDC4, #556270);
            color: #fff; font-weight: 900; cursor: pointer; border: none;
            margin-top: 10px; padding: 12px; border-radius: 50px;
            font-size: 1rem; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        button.action-btn:active { transform: translateY(1px); }
        
        button.rpg-btn {
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            margin-top: 15px; animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); } }

        .bazi-text {
            font-size: 0.9rem; color: #555; margin-top: 15px; line-height: 1.6;
            background: #f8f9fa; padding: 10px; border-radius: 12px; border: 1px dashed #ccc;
        }
        
        .date-confirm { font-size: 0.75rem; color: var(--secondary-color); margin-top: 8px; display: block; font-weight: bold; border-top: 1px dashed #ddd; padding-top: 5px; }

        #legend-container { display: none; margin-top: 15px; padding-top: 10px; border-top: 2px dashed #eee; }
        .legend-item { display: flex; align-items: center; margin-bottom: 8px; font-size: 0.85rem; font-weight: bold; }
        .dot { width: 10px; height: 10px; border-radius: 50%; margin-right: 10px; box-shadow: 0 0 5px currentColor; }
        .bar-container { flex-grow: 1; height: 8px; background: #eee; margin: 0 10px; border-radius: 4px; overflow: hidden; }
        .bar { height: 100%; border-radius: 4px; transition: width 0.6s ease-out; }
        .count-text { width: 40px; text-align: right; font-family: 'Nunito', monospace; opacity: 0.8; font-size: 0.8rem; }

        /* ÂÖçË≤¨ËÅ≤Êòé */
        .disclaimer {
            font-size: 0.65rem; color: #bbb; margin-top: 10px; text-align: center; line-height: 1.4; font-style: italic;
        }

        .toggle-details-btn {
            background: transparent; border: 2px solid #eee; color: #888;
            border-radius: 20px; margin-top: 15px; font-size: 0.8rem; padding: 6px;
            width: 100%; cursor: pointer; font-weight: bold;
        }

        /* === È†ÅÂ∞æ (Footer) === */
        #app-footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            text-align: center;
            padding: 15px 0;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            z-index: 5;
            pointer-events: none;
        }
        
        #app-footer .footer-content {
            pointer-events: auto;
            display: inline-block;
            background: rgba(0,0,0,0.3);
            padding: 8px 20px;
            border-radius: 20px;
            backdrop-filter: blur(3px);
        }

        #app-footer a {
            color: #fff; text-decoration: none; font-weight: bold;
            display: inline-flex; align-items: center; gap: 5px; margin-left: 10px; transition: color 0.2s;
        }
        #app-footer a:hover { color: #E1306C; }
        
        .brand-link-footer {
            display: block;
            margin-top: 5px;
            font-size: 0.7rem;
            color: rgba(255,255,255,0.5);
            text-decoration: none;
            transition: color 0.2s;
        }
        .brand-link-footer:hover { color: #fff; }

        .ig-icon { width: 14px; height: 14px; fill: currentColor; }

        /* === RPG Modal === */
        #rpg-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(20, 20, 30, 0.85); z-index: 100; justify-content: center; align-items: center;
            backdrop-filter: blur(8px); padding: 20px; box-sizing: border-box;
        }

        .rpg-card {
            width: 750px; max-width: 100%; height: 480px;
            background: #1a1a2e; border-radius: 30px;
            display: flex; overflow: hidden;
            box-shadow: 0 0 0 5px #1a1a2e, 0 0 0 8px #FF6B6B, 0 20px 50px rgba(0,0,0,0.8);
            position: relative; animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn { 0% { transform: scale(0.8) translateY(50px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }

        .rpg-visual {
            width: 40%; background: radial-gradient(circle at center, #333, #000);
            position: relative; display: flex; align-items: center; justify-content: center;
            border-right: 4px solid #1a1a2e; flex-shrink: 0;
        }
        .rpg-rarity-badge {
            position: absolute; top: 20px; left: 20px; padding: 8px 18px; border-radius: 12px;
            font-weight: 900; font-style: italic; font-size: 1.8rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.3); z-index: 2; transform: rotate(-5deg);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .rarity-SSR { background: linear-gradient(45deg, #FFD700, #FDB931); color: #fff; border: 3px solid #fff; }
        .rarity-SR { background: linear-gradient(45deg, #D980FA, #9980FA); color: #fff; border: 2px solid #fff; }
        .rarity-R { background: linear-gradient(45deg, #4ECDC4, #556270); color: #fff; border: 2px solid #fff; }

        .rpg-info {
            width: 60%; padding: 30px; display: flex; flex-direction: column;
            background: linear-gradient(135deg, #232526 0%, #414345 100%); color: white;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute; top: 15px; right: 20px; font-size: 2rem; cursor: pointer; color: #fff; z-index: 10;
            background: rgba(0,0,0,0.5); width: 40px; height: 40px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; line-height: 0; padding-bottom: 5px;
        }

        .rpg-header { margin-bottom: 10px; border-bottom: 2px dashed rgba(255,255,255,0.2); padding-bottom: 10px; }
        .rpg-class-type { font-size: 0.9rem; color: #FFE66D; text-transform: uppercase; letter-spacing: 2px; font-weight: bold; }
        .rpg-class-name { font-size: 2.2rem; font-weight: 900; margin: 5px 0; color: #fff; text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
        .rpg-desc { font-size: 0.95rem; color: #ddd; line-height: 1.6; background: rgba(0,0,0,0.3); padding: 12px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #FFE66D; }
        .chart-wrapper { position: relative; width: 100%; min-height: 180px; }
        .stats-list { display: flex; justify-content: space-between; margin-top: 10px; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 15px; }
        .stat-item { text-align: center; flex: 1; border-right: 1px solid rgba(255,255,255,0.1); }
        .stat-item:last-child { border-right: none; }
        .stat-item span { display: block; font-size: 0.7rem; color: #aaa; text-transform: uppercase; }
        .stat-item b { display: block; font-size: 1.2rem; color: #fff; margin-top: 2px; }

        /* === ÊâãÊ©üÁâàÈüøÊáâÂºèË®≠ÂÆö === */
        @media (max-width: 600px) {
            #ui-wrapper {
                top: 0;
                left: 0;
                width: 100%;
                flex-direction: column;
                align-items: center;
                transform: translateY(0);
                padding-top: 10px;
                pointer-events: none;
            }
            
            #ui-wrapper.collapsed {
                transform: translateY(calc(-100% + 30px));
            }

            #ui-container {
                pointer-events: auto;
                width: 94%;
                max-width: 400px;
                border-radius: 20px;
                border: 2px solid rgba(255,255,255,0.8);
                padding: 20px;
                max-height: 65vh;
                box-shadow: 0 10px 40px rgba(0,0,0,0.5);
                margin: 0 auto;
            }

            .toggle-panel-btn {
                pointer-events: auto;
                width: 60px;
                height: 30px;
                border-radius: 0 0 15px 15px;
                background: #fff;
                margin-top: -2px; 
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                font-size: 14px;
                color: var(--text-main);
                border: 1px solid #ddd;
                border-top: none;
            }

            h1 { font-size: 1.2rem; margin-bottom: 10px; }

            .rpg-card { 
                flex-direction: column; 
                height: 80vh; 
                width: 90%; 
                max-width: 400px;
                overflow: hidden; 
                border-radius: 20px;
            }
            
            .rpg-visual { 
                width: 100%; 
                height: 200px;
                border-right: none; 
                border-bottom: 3px solid #1a1a2e; 
                flex-shrink: 0;
            }
            
            .rpg-rarity-badge { font-size: 1.2rem; padding: 6px 12px; }
            
            .rpg-info { 
                width: 100%; 
                padding: 20px; 
                flex: 1; 
                overflow-y: auto; 
            }

            .rpg-class-name { font-size: 1.8rem; margin: 5px 0 10px 0; }
            .chart-wrapper { min-height: 160px; }
            .stats-list { padding: 8px; }
            .stat-item b { font-size: 1rem; }
            
            #app-footer {
                padding-bottom: 30px;
                background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
                z-index: 20;
            }
        }
    </style>
</head>
<body>

    <!-- UI ÊéßÂà∂Èù¢Êùø Wrapper -->
    <div id="ui-wrapper">
        <div id="ui-container">
            <h1>‚ú® ÂÖ´Â≠óËÉΩÈáèÂàÜÊûêÂÑÄ ‚ú®</h1>
            
            <div class="input-section">
                <div class="input-group">
                    <label>üéÇ ‰Ω†ÁöÑÂá∫ÁîüÊôÇÈñì (Ë•øÊõÜ)</label>
                    <input type="datetime-local" id="birth-input">
                </div>
                
                <div class="gender-group">
                    <div class="gender-option">
                        <input type="radio" name="gender" id="gender-m" value="1" class="gender-radio" checked>
                        <label for="gender-m" class="gender-label">‚ôÇ Áî∑Áîü</label>
                    </div>
                    <div class="gender-option">
                        <input type="radio" name="gender" id="gender-f" value="0" class="gender-radio">
                        <label for="gender-f" class="gender-label">‚ôÄ Â•≥Áîü</label>
                    </div>
                </div>

                <button class="action-btn" onclick="calculateBazi(true)">
                    üîÆ ÈñãÂßãÂàÜÊûêËÉΩÈáè
                </button>
            </div>

            <div class="bazi-text" id="bazi-desc">
                Ë´ãËº∏ÂÖ•Êó•Êúü‰ª•Êü•ÁúãËÉΩÈáè
            </div>

            <button class="action-btn rpg-btn" onclick="showRPGCard()">
                ‚öîÔ∏è Âè¨Âñö RPG ËßíËâ≤Âç°
            </button>

            <button class="toggle-details-btn" id="btn-toggle-legend" onclick="toggleLegend()">
                üìä È°ØÁ§∫Ë©≥Á¥∞Êï∏Êìö ‚ñº
            </button>
            
            <div id="legend-container">
                <!-- Êï∏ÊìöÊ¢ùÊúÉÊèíÂú®ÈÄôË£° -->
            </div>
            
            <!-- ÂÖçË≤¨ËÅ≤Êòé -->
            <div id="disclaimer-text" class="disclaimer" style="display:none;">
                ‰∫îË°åËÉΩÈáèÊ≤íÊúâÁ≤æÁ¢∫ÁßëÊäÄË®àÁÆóÔºåÂè™‰æõÂèÉËÄÉÂèäÂ®õÊ®Ç
            </div>
        </div>
        
        <!-- Èö±Ëóè/È°ØÁ§∫ÊåâÈàï -->
        <div class="toggle-panel-btn" onclick="togglePanel()">‚óÄ</div>
    </div>

    <!-- È†ÅÂ∞æ (Footer) -->
    <footer id="app-footer">
        <div class="footer-content">
            ¬© 2025 ÈÄ∏Êô¥ÂëΩÁêÜ All Rights Reserved.
            <a href="https://instagram.com/start_8words" target="_blank">
                <svg class="ig-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                </svg>
                @start_8words
            </a>
            <a href="https://start8words.com" target="_blank" class="brand-link-footer">
                Â∞àÊ•≠ÂÖ´Â≠óÊéíÁõ§Â∑•ÂÖ∑ start8words.com
            </a>
        </div>
    </footer>

    <!-- RPG ËßíËâ≤Âç° Modal -->
    <div id="rpg-modal" onclick="closeRPGModal(event)">
        <div class="rpg-card">
            <span class="close-modal" onclick="document.getElementById('rpg-modal').style.display='none'">&times;</span>
            
            <div class="rpg-visual">
                <div id="rarity-badge" class="rpg-rarity-badge rarity-SSR">SSR</div>
                <div id="class-visual-bg" style="width:100%; height:100%; background: #333; display: flex; align-items: center; justify-content: center; font-size: 6rem; text-shadow: 0 10px 20px rgba(0,0,0,0.5);">
                    üó°Ô∏è
                </div>
            </div>

            <div class="rpg-info">
                <div class="rpg-header">
                    <div class="rpg-class-type" id="rpg-main-type">MAIN CLASS</div>
                    <div class="rpg-class-name" id="rpg-job-name">ËÅ∑Ê•≠ÂêçÁ®±</div>
                </div>
                
                <div class="rpg-desc" id="rpg-job-desc">
                    ËÅ∑Ê•≠ÊèèËø∞...
                </div>

                <div class="chart-wrapper">
                    <canvas id="statsChart"></canvas>
                </div>

                <div class="stats-list" id="stats-text-row">
                    <!-- JS Populated -->
                </div>
            </div>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        // --- JS Logic Updates for Panel Toggle ---
        
        function togglePanel(forceState = null) {
            const wrapper = document.getElementById('ui-wrapper');
            const btn = document.querySelector('.toggle-panel-btn');
            const isMobile = window.innerWidth <= 600;
            
            // Â¶ÇÊûúÊåáÂÆö‰∫ÜÁãÄÊÖãÔºåÂ∞±‰ΩøÁî®Ë©≤ÁãÄÊÖãÔºåÂê¶ÂâáÂàáÊèõ
            if (forceState !== null) {
                if (forceState === 'collapse') wrapper.classList.add('collapsed');
                else wrapper.classList.remove('collapsed');
            } else {
                wrapper.classList.toggle('collapsed');
            }
            
            const isCollapsed = wrapper.classList.contains('collapsed');

            if (isMobile) {
                btn.innerText = isCollapsed ? '‚ñº' : '‚ñ≤';
            } else {
                btn.innerText = isCollapsed ? '‚ñ∂' : '‚óÄ';
            }
        }

        // --- 1. RPG ËÅ∑Ê•≠Êï∏ÊìöÂ∫´ ---
        const RPG_DATA = {
            wood: {
                label: "Êú®Á≥ª (Wood)", color: "#2ecc71",
                mainA: { name: "üèπ ÈÅä‰ø†Á≥ª (Ranger)", icon: "üèπ" },
                mainB: { name: "üåø Âæ∑È≠Ø‰ºäÁ≥ª (Druid)", icon: "üåø" },
                branches: {
                    wood:  [{ n:"üßù Á≤æÈùàÈÅä‰ø†", d:"Ëá™Á®±Ê£ÆÊûóÁÆ°ÁêÜÂì°ÔºåÂ∞ÑÁÆ≠Ê∫ñÈÅéÈñãAimbot„ÄÇ‰∏çÈÅéÊàêÊó•ÁÇ∫ÂíóÈÇäÂÄãÊ®πÁ™øÂ•ΩÁûìÂï≤ÂêåÊùæÈº†ÈñãÁâáÔºåË™çÁúüÁÑ°ËÅä„ÄÇ" }, { n:"üå≤ Ê£ÆÊûó‰πãÂ≠ê", d:"Ë≠òÂêåÊ§çÁâ©ÂÇæË®àÔºå‰ΩÜËÅΩË¨õÂï≤Ê®πÊàêÊó•ÊäïË®¥ÁïÄÁãóÈÄöË°óÂ±ôÂ∞ø„ÄÇÊâì‰∫§Âó∞Èô£Âè´ÈöªÊ®π‰∫∫Âá∫ÂöüÈ†ÇÔºåËá™Â∑±Á∏ÆÂñ∫ÂæåÈù¢ÂòÜËä±Ëå∂„ÄÇ" }],
                    metal: [{ n:"üéØ ÁãôÊìäÊâã", d:"Â∞àÁî®Á©øÁî≤ÁÆ≠ÁàÜÁ°¨Âò¢„ÄÇÊàêÊó•Êá∂ÂûãË©±„ÄåI see you„ÄçÔºåÂÖ∂ÂØ¶‰øÇËøëË¶ñÊ∑±Âà∞Ê∑®‰øÇÁùáÂà∞ÂÄãScopeÂÖ•Èù¢ÔºåÈô§ÁúºÈè°Â∞±Áõ≤„ÄÇ" }, { n:"ü•Ä ËçäÊ£òË°ìÂ£´", d:"ÈêòÊÑèÁé©Â∞ñÂò¢ÂòÖÂç±Èö™‰∫∫Áâ©„ÄÇ‰Ω¢Á®ÆÂï≤Ëä±ÂîîÈñãËä±Ê∑®‰øÇÁîüÂà∫ÔºåÊúâSÂÇæÂêëÔºåÈùûÂ∏∏ÈáçÂè£Âë≥„ÄÇ" }],
                    water: [{ n:"üå´Ô∏è ÈúßÂΩ±ÁçµÊâã", d:"Áé©Êçâ‰ºä‰∫∫‰∏ñÁïåÂÜ†ËªçÔºåÈö±ÂΩ¢Èö±Âà∞ÈÄ£ÈöäÂèãÈÉΩÁï∂‰Ω¢ÈÄèÊòéÔºåÂóåÂ§ñË≥£Ê∞∏ÈÅ†È†êÂ∞ë‰Ω¢Âó∞‰ªΩÔºåÊÖòÈÅéÂÅöÂÖµ„ÄÇ" }, { n:"üåä ÊΩÆÊ±ê‰ΩøËÄÖ", d:"ÂÖ®ÈöäÊúÄÂº∑Â•∂Â™ΩÔºåÊ∞¥Â§öÂà∞Êµ∏Ê≠ª‰∫∫„ÄÇÈõñÁÑ∂Ë£úË°ÄÂãÅÔºå‰ΩÜÊàêÊó•ÂîîÂ∞èÂøÉÊ≤ñËµ∞ÂüãÈöäÂèãÔºåÊêûÂà∞Ë¶ÅCallÂüãÊ∞¥Ë≠¶„ÄÇ" }],
                    fire:  [{ n:"üí• ÁàÜË£ÇÁÆ≠Êâã", d:"Â´åÂ∞ÑÁÆ≠Â§™DryÔºåÁ°¨Ë¶ÅÂä†ÁÅ´Ëó•„ÄÇÊîØÁÆ≠È£õÂá∫Âéª‰ººÊîæÁÖôËä±Â§öÈÅéÊÆ∫‰∫∫Ôºå‰∏çÈÅé‰øÇÊúÉÁÇ∏Ê≠ª‰∫∫Âó∞ÈöªÁÖôËä±Âõâ„ÄÇ" }, { n:"‚òÄÔ∏è ÁÉàÈôΩËñ©Êªø", d:"Â∏∂‰ΩèÂÄãÊµÅÂãïÂ∞èÂ§™ÈôΩÂá∫Ë°ó„ÄÇBuff‰øÇÂãÅÔºå‰ΩÜÂÖâÂà∞ÈöäÂèãÈÉΩË¶ÅÊà¥ÈªëË∂ÖÊâì‰∫§ÔºåÂîî‰øÇÈõÜÈ´îÈõ™Áõ≤ÈÉΩÊúâ‰πã„ÄÇ" }],
                    earth: [{ n:"üçÉ Âè¢ÊûóÂÆàË≠∑ËÄÖ", d:"Áí∞‰øùLÂÖ•Ë°ÄÔºåÈô∑Èò±setÂæó‰ª≤Ë¨õÁ©∂ÈÅé‰Ω¢ÈñìÊàø„ÄÇÂîîÂ•ΩË∏©‰Ω¢Âï≤ËçâÂëÄÔºåÂîî‰øÇÊ∑®‰øÇÊãÆÊ≠ª‰Ω†Ôºå‰ª≤Ë¶ÅËÅΩ‰Ω¢Ë¨õ‰∏âÂÄãÈêòËÄ∂Á©å„ÄÇ" }, { n:"üóø Â±±Â∂∫Â∑®‰∫∫", d:"Âπ≥ÊôÇ‰øÇËàäÁü≥ÔºåÊâì‰∫§‰øÇËàäÂ•ΩÂ¨≤ÂòÖÁü≥„ÄÇÁöÆÁ°¨Âà∞ËöäÈáù‰Ω¢ÈÉΩÊñ∑Èáù„ÄÇÂîØ‰∏ÄÁÖ©ÊÉ±‰øÇÊàêÊó•ÁïÄÈÅäÂÆ¢Áï∂ÊôØÈªûÂΩ±Áõ∏ÊâìÂç°„ÄÇ" }]
                }
            },
            fire: {
                label: "ÁÅ´Á≥ª (Fire)", color: "#ff3d00",
                mainA: { name: "üî• ÁÇéÈ≠îÂ∞éÁ≥ª (Pyromancer)", icon: "üî•" },
                mainB: { name: "üò° ÁãÇÊà∞Â£´Á≥ª (Berserker)", icon: "üò°" },
                branches: {
                    fire:  [{ n:"‚òÑÔ∏è ÊØÄÊªÖ‰πãÁéã", d:"Á†¥Â£ûÁãÇÈ≠îÔºå‰∫∫ÁîüÊ†ºË®Ä‰øÇ„ÄåÁàÜÂï¶„Äç„ÄÇË°åÈÅéÂòÖÂú∞ÊñπÂØ∏Ëçâ‰∏çÁîüÔºåÈÄ£Âú∞ÁöÆÈÉΩËµ∑ÂüãÔºåÁí∞‰øùÂúòÈ´îÈ†≠ËôüÈÄöÁ∑ùÁäØ„ÄÇ" }, { n:"üëπ ‰øÆÁæÖ", d:"Ë¶∫ÂæóÊªøË°Ä‰øÇÂª¢Êü¥ÔºåÊÆòË°ÄÂÖà‰øÇÁúüÁî∑‰∫∫ÂòÖÁó¥Á∑ö‰Ω¨„ÄÇÊâì‰∫§Âó∞Èô£‰øÇÂíÅÂè´„ÄåÊâìÊàëÂï¶Á¨®„ÄçÔºåÈÜ´ÁîüË¶ãÂà∞ÈÉΩÈ†≠Áóõ„ÄÇ" }],
                    metal: [{ n:"‚ö° ÈõªÊºøË°ìÂ£´", d:"Áé©ÁÅ´Áé©Âà∞ËÆäÈõªÊºøÔºåÁÜ±Âà∞Áû¨ÈñìËí∏ÁôºÁâõÊâí„ÄÇÂîîÂ•ΩÂïè‰Ω¢ÂÄüÁÅ´È£üÁÖôÔºåÂàÜÂàÜÈêòÈÄ£ÂÄãËÇ∫ÈÉΩÊ∞£ÂåñÂüã„ÄÇ" }, { n:"‚öîÔ∏è Êà∞Á•û", d:"ÂçÅÂÖ´Ëà¨Ê≠¶ËóùÊ®£Ê®£Á≤æÔºåÂãÅÂà∞ÁÑ°ÊúãÂèã„ÄÇËÅΩË¨õ‰Ω¢Áî®ÈöªÂåôÁæπÈÉΩÊÆ∫Âà∞‰∫∫ÔºåÊêûÂà∞È£üÈ£ØÁÑ°‰∫∫Êï¢Êê∂‰Ω¢ÂÄãÂ∏É‰∏Å„ÄÇ" }],
                    wood:  [{ n:"üïØÔ∏è ÈáéÁÅ´Á•≠Âè∏", d:"‰ø°Â•âÁÅ´ÂèØ‰ª•Ê∑®Âåñ‰∏ÄÂàáÔºåÂ∞§ÂÖ∂‰øÇÂ∞çÈù¢Ê¢ùË°Ä„ÄÇ‰Ω¢Âï≤ÁÅ´ÊúÉÂÇ≥ÊüìÔºåÈöäÂèãË¶ãÂà∞‰Ω¢ÈÉΩËá™Â∏∂Social DistanceÔºåÈ©öËÆäÂä©ÁáÉÁâ©„ÄÇ" }, { n:"üßõ Ë°ÄÈ≠î", d:"Âê∏Ë°ÄÈ¨ºÂï≤Ë¶™ÊàöÔºåÊâì‰∫§Áï∂È£üBuffet„ÄÇÂè™Ë¶ÅÊúâ‰∫∫Êú™Ê≠ª‰Ω¢Â∞±ÂîîÊúÉÈ§ìÊ≠ªÔºåÊÖ≥‰ºôÈ£üË≤ªÈ¶ñÈÅ∏ÈöäÂèã„ÄÇ" }],
                    water: [{ n:"üí® Ëí∏Ê±ΩË°ìÂ£´", d:"Ê∞¥ÁÅ´Ê∑∑ÂêàÂòÖÊÄ™ÊâçÔºåÊà∞Â†¥ÊêûÂà∞ÊàêÂÄãÊ°ëÊãøÊàøÂíÅ„ÄÇÈõñÁÑ∂ÊúÉÁáôÂÇ∑‰∫∫Ôºå‰ΩÜÊâìÂÆå‰ªóÂ§ßÂÆ∂ÁöÆËÜöÂ•ΩÂíóÔºåÁÆó‰øÇÁ¶èÂà©Ôºü" }, { n:"üõ°Ô∏è Á∂≠‰∫¨Êµ∑Áõú", d:"Â§©‰∏çÊÄïÂú∞‰∏çÊÄïÔºåÊúÄÊÄïÁÑ°ÈÖíÈ£≤„ÄÇÂõ†ÁÇ∫Èï∑ÊúüÈÖíÁ≤æ‰∏äËÖ¶ÔºåÈÄ£ÁóõË¶∫ÈÉΩÈ∫ªÁó∫ÂüãÔºåÊâÄ‰ª•ÂîîÊÄïÁóõÂîîÊÄïÊöà„ÄÇ" }],
                    earth: [{ n:"üåã ÁÜîÂ≤©È†ò‰∏ª", d:"ÈêòÊÑèÁé©ÂπæÂçÉÂ∫¶ÂòÖÊ≥•Ê≤ô„ÄÇÁÑ°Âï¶Âï¶Âè¨ÂñöÈöïÁü≥Êâë‰∫∫ÔºåÂÆåÂÖ®ÁÑ°ÁêÜÈÅé‰øÆË∑ØÂ∑•‰∫∫ÂòÖÊÑüÂèóÔºåÊ•µÂ∫¶Áº∫Âæ∑„ÄÇ" }, { n:"üí™ Ë†ªÁéã", d:"ËÇåËÇâÁîü‰∏äËÖ¶ÂòÖ‰ª£Ë°®„ÄÇÂõ†ÁÇ∫Â§™Ë†¢ÔºåÊ≠ªÁ•ûÂöüÊî∂ÂëΩ‰Ω¢ÈÉΩÂîîÁü•Ëá™Â∑±Ê≠ªÂíóÔºåÊâÄ‰ª•‰ª≤ÂèØ‰ª•ÊâìÂ§öÈô£ÔºåÁó¥Á∑ö„ÄÇ" }]
                }
            },
            earth: {
                label: "ÂúüÁ≥ª (Earth)", color: "#ffc107",
                mainA: { name: "üõ°Ô∏è ËÅñÈ®éÂ£´Á≥ª (Paladin)", icon: "üõ°Ô∏è" },
                mainB: { name: "‚öóÔ∏è ÁÖâÈáëË°ìÂ£´Á≥ª (Alchemist)", icon: "‚öóÔ∏è" },
                branches: {
                    earth: [{ n:"üïç ‰∏çÂãïÊòéÁéã", d:"‰ºÅÂÆöÂÆöÁïÄ‰Ω†ÊâìÔºåÊâìÂà∞‰Ω†ÊâãËªü‰Ω¢‰ª≤ÊåñÁ∑äÈºªÂ±é„ÄÇÂèçÂÇ∑ÂãÅÂà∞Â∞çÈù¢‰ª•ÁÇ∫ÊâìÁ∑äÂ°äÈï∑ÊªøÂà∫ÂòÖÈè°ÔºåÁóõÈÅéËá™ÊÆò„ÄÇ" }, { n:"ü§ñ È≠îÂÉèÂ§ßÂ∏´", d:"Êâã‰ΩúÈÅî‰∫∫ÔºåÊêìÊ≥•Áé©Âà∞ÊúâÊà∞È¨•Âäõ„ÄÇËá™Â∑±Á∏ÆÂæåÈù¢ÈÅôÊéßÔºåÂ†Ö‰ø°„ÄåÊúâ‰∫ãÂºüÂ≠êÊúçÂÖ∂Âãû„ÄçÔºåÂÄãÂºüÂ≠êÂí™ËàäÁü≥Âõâ„ÄÇ" }],
                    metal: [{ n:"üè∞ ËÅñÊÆøÈ®éÂ£´", d:"Â°äÁõæÂ§ßÈÅéÂÄã‰∫∫ÔºåÂ∞àÈï∑Áî®Áõæ„ÄåËºïËºï„ÄçÊâëÊöà‰∫∫„ÄÇ‰∏çÈÅé‰Ω¢ÂÄã„ÄåËºïËºï„ÄçÈÄöÂ∏∏ÈÉΩ‰º¥Èö®ËëóÈáçÂ∫¶ËÖ¶ÈúáÁõ™„ÄÇ" }, { n:"ü¶æ Èãº‰πãÁÖâÈáëÂ∏´", d:"‰ø°Á≠âÂÉπ‰∫§ÊèõÔºåÈÄöÂ∏∏‰øÇÁî®Êïµ‰∫∫Ê¢ùÂëΩÊèõ‰Ω¢ÈñãÂøÉ„ÄÇÊà∞Â†¥Áï∂Á©çÊú®Á†åÔºåË∑ØÁó¥ÈöäÂèãÂòÖÊÉ°Â§¢„ÄÇ" }],
                    wood:  [{ n:"‚ú® ÂÖâ‰πãÂÆàË°õ", d:"Ëá™Â∏∂ÁæéÈ°èFilterÔºåÈªûÊâìÈÉΩÂîîÊ≠ª„ÄÇÂ∞èÂº∑Á¥öÁîüÂëΩÂäõÂä†ÂüãÂÅ∂ÂÉèÊ¥æÁôªÂ†¥ÔºåÂîîÁü•ÊÑõ‰Ω¢ÂÆöÊÅ®‰Ω¢Â•Ω„ÄÇ" }, { n:"üß™ Ëó•ÂäëÂ§ßÂ∏´", d:"Áô≤‰Ω¨ÁßëÂ≠∏ÂÆ∂ÔºåÊè∏‰ΩèÂ†ÜÁ¥ÖÁ¥ÖÁ∂†Á∂†ÂòÖÊ∞¥„ÄÇË©±‰øÇËó•Ê∞¥ÔºåÈ£≤ËêΩ‰ººÈÅéÊúüÂ•∂ÔºåÂèçÊ≠£Ê≠ªÂîîÂéªÂ∞±ÁÆóÊàêÂäüÂï¶„ÄÇ" }],
                    water: [{ n:"‚öñÔ∏è ÂØ©Âà§ÂÆò", d:"Ê•µÂ∫¶ÊΩîÁôñÔºåË¶ãÂà∞DebuffÂ∞±Ë¶ÅÊ∏Ö„ÄÇÂ∞çÈöäÂèãË∫´‰∏äÂòÖË≤†Èù¢ÁãÄÊÖãÈõ∂ÂÆπÂøçÔºåÊúâÊôÇÈÄ£ÈöäÂèãÂπæÊó•ÁÑ°Ê≤ñÊ∂ºÈô£Âë≥ÈÉΩÊÉ≥Ê∑®ÂåñÂüã„ÄÇ" }, { n:"üìñ Ë≥¢ËÄÖ", d:"ËÆÄÊõ∏ËÆÄÂ£ûËÖ¶Ôºå‰ΩÜÂõ†ÁÇ∫ËÆÄÂæóÂ§öÔºåÈÄ£‰Ω†ËëóÂí©Ëâ≤Â∫ïË§≤ÈÉΩÁü•„ÄÇÁùáÁ©øÂº±Èªû‰øÇÂõ†ÁÇ∫‰Ω¢ËÉåÁÜüÊôíÊïµ‰∫∫ÂúñÈëëÔºåÂ±àÊ©ü„ÄÇ" }],
                    fire:  [{ n:"üåÖ ÈªéÊòé‰ΩøËÄÖ", d:"Ë°åËµ∞ÁöÑÁáàÊ≥°ÔºåÂñ™Â±çÂâãÊòü„ÄÇÂõ†ÁÇ∫Â§™ÂÖâÔºåÂ§úÊôöË®ìÊïôË¶ÅËá™ÈñâÂñ∫ÂÄãÂîîÈÄèÂÖâÂòÖÁÆ±ÂÖ•Èù¢ÔºåÂ¶ÇÊûúÂú®Âîî‰øÇÊúÉË¢´‰∫∫ÊäïË®¥ÂÖâÊ±°Êüì„ÄÇ" }, { n:"üí£ ÁÇ∏ÂΩàÁãÇ‰∫∫", d:"Ë¶∫ÂæóÁàÜÁÇ∏‰øÇËóùË°ìÂòÖÊÅêÊÄñ‰ªΩÂ≠ê„ÄÇÂêå‰Ω¢‰∏ÄÈöäË¶ÅÂ∞èÂøÉÂú∞‰∏ãÔºåÂàÜÂàÜÈêòÈÄ£‰Ω†ÂÄãË¢ãÈÉΩÁïÄ‰Ω¢Â°ûÂíóÂÄãÈ©öÂñúÂåÖ„ÄÇ" }]
                }
            },
            metal: {
                label: "ÈáëÁ≥ª (Metal)", color: "#e0e0e0",
                mainA: { name: "‚öîÔ∏è ÂäçËÅñÁ≥ª (Blade Master)", icon: "‚öîÔ∏è" },
                mainB: { name: "ü§ñ Ê©üÊ¢∞Â∏´Á≥ª (Machinist)", icon: "ü§ñ" },
                branches: {
                    metal: [{ n:"üó°Ô∏è ÁÑ°Ê•µÂäçÁ•û", d:"Ë¶∫ÂæóÈò≤Á¶¶‰øÇÊá¶Â§´Ôºå‰∏ÄÂäçÁ†¥Ëê¨Ê≥ï„ÄÇÂõ†ÁÇ∫ÁÑ°Ë¶ñÈò≤Á¶¶ÔºåÊñ¨Âù¶ÂÖãÂêåÊñ¨Ë±ÜËÖê‰∏ÄÊ®£ÔºåÈÉΩ‰øÇ‰∏ÄÂäàÂ∞±Èñã„ÄÇ" }, { n:"üöú Ê©üÁî≤Êà∞Á•û", d:"Êè∏È´òÈÅî‰øÇÁî∑‰∫∫ÂòÖÊµ™Êº´„ÄÇÈò≤Á¶¶È´òÁÅ´ÂäõÁåõÔºåÂîØ‰∏ÄÁº∫Èªû‰øÇÁ∂≠‰øÆË≤ªË≤¥Âà∞‰Ω¢ÊàêÊó•Ë¶ÅÈ£üÂúü„ÄÇ" }],
                    wood:  [{ n:"üçÉ ÁñæÈ¢®ÂäçË±™", d:"Âø´Ê®ÇÈ¢®Áî∑ÔºåÊªëÂöüÊªëÂéªÊçâ‰Ω¢ÂîîÂà∞„ÄÇÈñÉÈÅøÈ´òÂà∞Êá∑Áñë‰Ω¢ÈñãÊéõÔºåÊàñËÄÖÂñÆÁ¥î‰øÇÈÅéÂ∫¶Ê¥ªË∫çÁóá„ÄÇ" }, { n:"ü¶† ÁîüÂåñÊà∞Â£´", d:"ÊîπÈÄ†ÊàêÂçä‰∫∫ÂçäÊ©üÊ¢∞ÂòÖÊÄ™ËÉé„ÄÇÂèóÂÇ∑ÂîîÁî®ËÜ†Â∏ÉÔºåÁõ¥Êé•ÊãøÂ£´Â∑¥ÊãøÂêåÂÅàÊ≤πÊï¥ÂÖ©Êï¥Â∞±ÂæóÔºåÊÖ≥ËøîÂîîÂ∞ëÈÜ´Ëó•Ë≤ª„ÄÇ" }],
                    water: [{ n:"‚ùÑÔ∏è ÈúúÂØíÂäçÂ£´", d:"ÂÜ∑Ê∞£Ê©üÊàêÁ≤æ„ÄÇÊØè‰∏ÄÂäçÈÉΩËá™Â∏∂Èõ™ÊàøÊïàÊûúÔºåÂ§èÂ§©ÊúÄÂèóÊ≠°ËøéÈöäÂèãÔºåÂÜ¨Â§©Â§ßÂÆ∂Âç≥ÂàªË∏¢‰Ω¢Âá∫Èöä„ÄÇ" }, { n:"ü§ø Ê∑±Êµ∑ÊΩõËà™ËÄÖ", d:"ËëóÊΩõÊ∞¥Ë°´Âñ∫Èô∏Âú∞Ë∑ëÂòÖÊÄ™‰∫∫„ÄÇÁî®Ê∞¥ÂàÄÂàá‰∫∫Áï∂ÂàáË•øÁìúÔºåÈõñÁÑ∂Â§ßÂÆ∂ÈÉΩRÈ†≠‰Ω¢Âï≤Ê∞¥Âà∞Â∫ïÂñ∫ÈÇäÂ∫¶ÊäΩÈÅéÂöü„ÄÇ" }],
                    fire:  [{ n:"üî• È≠îÂäçÂ£´", d:"Áâ©È≠îÈõô‰øÆÂòÖÂ≠∏Èú∏„ÄÇÊääÂäçËëóÁÅ´Â•Ω‰ººÂ•ΩÂûãÔºåÂÖ∂ÂØ¶Â•ΩÂπæÊ¨°ÂîîÂ∞èÂøÉÁáíÁá∂Ëá™Â∑±Ê¢ùÁúâ„ÄÇ" }, { n:"üß® ÁàÜÁ†¥Â∞àÂÆ∂", d:"ÁÇ∏ÂΩàÁãÇ‰∫∫ÂÄãFriendÔºå‰ΩÜÈêòÊÑèÂ§ßÂ†¥Èù¢„ÄÇÊéüÁÇ∏ÂΩà‰ººÊ¥æÂÇ≥ÂñÆÔºåËá¥ÂäõÂ∞áÂú∞ÂúñÊØè‰∏ÄÂÄãÂá∏Ëµ∑ÂòÖÂú∞ÊñπÈÉΩÁÇ∏Âπ≥„ÄÇ" }],
                    earth: [{ n:"üõ°Ô∏è ÈáçË£ùÂäçÂ£´", d:"Êè∏‰ΩèÂ°äÈñÄÊùøÂíÅÂ§ßÂòÖÂäçÔºåË°åÂæóÊÖ¢ÈÅéÈöªÈæú„ÄÇÈõñÁÑ∂ÊÖ¢Ôºå‰ΩÜÁïÄ‰Ω¢Êè©‰∏≠‰∏Ä‰∏ãÂü∫Êú¨‰∏äÂèØ‰ª•Áõ¥Êé•ÊäïËÉé„ÄÇ" }, { n:"üöß ÊîªÂüéÂù¶ÂÖã", d:"ÂùêÂÆöÂÆöÊâì‰∫§ÂòÖÊ•µËá¥„ÄÇÂ∞ÑÁ®ãÈÅ†Âà∞ÈöîÁ±¨Âú∞ÂúñÈÉΩÊâìÂà∞‰Ω†Ôºå‰ΩÜÊïµ‰∫∫Ë°ùÂà∞ÂüãÂöü‰Ω¢ÂèØËÉΩÈÄ£ËΩâË∫´ÈÉΩÊú™ËΩâÂà∞„ÄÇ" }]
                }
            },
            water: {
                label: "Ê∞¥Á≥ª (Water)", color: "#0091ea",
                mainA: { name: "üó°Ô∏è ÂΩ±ËàûËÄÖÁ≥ª (Shadow Dancer)", icon: "üó°Ô∏è" },
                mainB: { name: "üîÆ Âç†ÊòüÂ∏´Á≥ª (Astrologer)", icon: "üîÆ" },
                branches: {
                    water: [{ n:"üëª ÂπªÂΩ±Âà∫ÂÆ¢", d:"Â≠òÂú®ÊÑü‰ΩéÂà∞Ëá™ÂãïÈñÄÈÉΩÊÑüÊáâÂîîÂà∞„ÄÇÁàÜÁôºÂäõÂãÅÔºåÊâìÂÆåÂ∞±ÈñÉÔºåÂÖ∏Âûã„ÄåÂ∞ÑÂæå‰∏çÁêÜ„ÄçÂòÖÊ∏£Áî∑„ÄÇ" }, { n:"üëë ÂÜ∞Èõ™Â•≥Áöá", d:"È´òÂÜ∑Â•≥ÁéãÔºåÁúü‰øÇÁâ©ÁêÜ‰∏äÂòÖÈ´òÂÜ∑„ÄÇÊà∞Â†¥ËÆäÊ∫úÂÜ∞Â†¥ÔºåÊúÄÈêòÊÑèÁùáÊïµ‰∫∫Âú®ÂÜ∞‰∏äÈù¢‰ªÜË¶™„ÄÇ" }],
                    metal: [{ n:"ü©∏ ËôïÂàëËÄÖ", d:"ÈêòÊÑèÁùá‰∫∫ÊµÅË°ÄÂòÖËÆäÊÖã„ÄÇÂ∞àÊâìÁóõ‰ΩçÔºåÁïÄ‰Ω¢ÊâìÊú™ÂøÖÊ≠ªÔºå‰ΩÜ‰∏ÄÂÆöÁóõÂà∞Êá∑Áñë‰∫∫Áîü„ÄÇ" }, { n:"ü™û Èè°ÂÉèÊ≥ïÂ∏´", d:"ÈêòÊÑèÁé©ÂàÜË∫´„ÄÇ‰Ω†‰ª•ÁÇ∫Êâì‰∏≠‰Ω¢ÔºåÂÖ∂ÂØ¶‰øÇÈè°Ôºõ‰Ω†‰ª•ÁÇ∫‰øÇÈè°ÔºåÂÖ∂ÂØ¶‰øÇÁÇ∏ÂΩà„ÄÇÂêå‰Ω¢Êâì‰∫§Ê•µÂ∫¶ËÄÉÈ©óÊô∫ÂïÜ„ÄÇ" }],
                    wood:  [{ n:"‚ò†Ô∏è ÂäáÊØí‰πãÂàÉ", d:"ÂÖ®Ë∫´ÈÉΩ‰øÇÊØí„ÄÇÂêå‰Ω¢È£üÈ£ØË¶ÅÁî®ÈäÄÈáùË©¶ÊØíÔºåÈÄ£Ê±óÈÉΩÊúâËÖêËùïÊÄßÔºåÁîü‰∫∫ÂãøËøëÔºåÂñÆË∫´ÂØ¶ÂäõÊ¥æ„ÄÇ" }, { n:"üëÅÔ∏è È†êË®ÄÂÆ∂", d:"Á•ûÊ£ç...ÂïäÂîî‰øÇÔºåÂÖàÁü•„ÄÇÊàêÊó•Á•ûÁ•ûÂåñÂåñË¨õÂüãÂï≤ËÅΩÂîîÊòéÂòÖÂò¢ÔºåÁÑ∂ÂæåÂπ´‰Ω†‰∏äBuff„ÄÇÈ†êË®ÄÂîîÊ∫ñÂ∞±Ë©±‰øÇÊôÇÈñìÁ∑öËÆäÂãïÂõâ„ÄÇ" }],
                    fire:  [{ n:"ü•∑ Á¥ÖËìÆÂøçËÄÖ", d:"ÈõñÁÑ∂‰øÇÂøçËÄÖ‰ΩÜÂÆåÂÖ®Âîî‰ΩéË™øÔºåÂøçË°ìÂÖ®ÈÉ®ÈÉΩ‰øÇÁàÜÁÇ∏ÂêåÁÅ´„ÄÇ‰ø°Â•â„ÄåÁÇ∏Ê≠ªÊôíÁõÆÊìäËÄÖÂ∞±‰øÇÂÆåÁæéÊΩõÂÖ•„Äç„ÄÇ" }, { n:"üå† ÊòüÁÅ´Ë°ìÂ£´", d:"Â´åÂú∞ÁêÉÂï≤ÁÅ´ÂîîÂ§†ÂãÅÔºåË¶ÅÂÄüÊòüÊòüÁÅ´„ÄÇÂ®ÅÂäõÂ§ßÂà∞ÁÑ°Ë¶ñÊäóÊÄßÔºå‰ΩÜÂõ†ÁÇ∫ÂÄüÂòÖ‰øÇÈ´òÂà©Ë≤∏(Ê≥ïÂäõ)ÔºåÊàêÊó•Â∞áËá™Â∑±Ê¶®‰πæ„ÄÇ" }],
                    earth: [{ n:"üèúÔ∏è Ê≤ôÊö¥Ë°åËÄÖ", d:"Ëá™Â∏∂Ê≤ôÂ°µÊö¥BGM„ÄÇÂêå‰Ω¢Êâì‰∫§‰ººÂñ∫Ê≤ôÁÅòÈ£üÈ£ØÔºåÊàêÂè£Ê≤ôÔºåÂëΩ‰∏≠‰ΩéÂà∞Êá∑ÁñëËá™Â∑±ÁôºÈõûÁõ≤„ÄÇ" }, { n:"ü™ê ÈáçÂäõÊìçÁ∏±ËÄÖ", d:"ÁâõÈ†ìÊ≠ªÂ∞çÈ†≠„ÄÇÊÉ≥‰Ω†È£õÂ∞±È£õÔºåÊÉ≥‰Ω†Ë∑™Â∞±Ë∑™„ÄÇÂøÉÊÉÖÂîîÈùöÂ∞á‰Ω†È´îÈáçËÆä‰∏âÂÄçÔºåÊ∏õËÇ•‰∫∫Â£´ÊÉ°Â§¢„ÄÇ" }]
                }
            }
        };

        // --- 2. ÊéíÁõ§ÈÇèËºØ ---
        const GAN_WUXING = { 'Áî≤':'wood','‰πô':'wood','‰∏ô':'fire','‰∏Å':'fire','Êàä':'earth','Â∑±':'earth','Â∫ö':'metal','Ëæõ':'metal','Â£¨':'water','Áô∏':'water' };
        const ELEMENT_CN = { 'wood':'Êú®', 'fire':'ÁÅ´', 'earth':'Âúü', 'metal':'Èáë', 'water':'Ê∞¥' };
        const ZHI_CANGGAN = {
            'Â≠ê':{water:100}, '‰∏ë':{earth:60,water:25,metal:15}, 'ÂØÖ':{wood:60,fire:30,earth:10},
            'ÂçØ':{wood:100}, 'Ëæ∞':{earth:60,wood:25,water:15}, 'Â∑≥':{fire:60,earth:25,metal:15},
            'Âçà':{fire:70,earth:30}, 'Êú™':{earth:60,fire:30,wood:10}, 'Áî≥':{metal:60,water:30,earth:10},
            'ÈÖâ':{metal:100}, 'Êàå':{earth:60,metal:30,fire:10}, '‰∫•':{water:70,wood:30}
        };

        const baseTotal = 2500;
        let currentRatios = { wood: 0.2, fire: 0.2, earth: 0.2, metal: 0.2, water: 0.2 };
        let currentChart = null;

        const elementsDef = [
            { id: 'wood',  name: 'Êú®', cssColor: '#00d26a', baseH: 0.38, baseS: 0.85, baseL: 0.40 },
            { id: 'fire',  name: 'ÁÅ´', cssColor: '#ff3d00', baseH: 0.02, baseS: 0.95, baseL: 0.45 },
            { id: 'earth', name: 'Âúü', cssColor: '#ffc107', baseH: 0.11, baseS: 0.90, baseL: 0.45 },
            { id: 'metal', name: 'Èáë', cssColor: '#e0e0e0', baseH: 0.55, baseS: 0.10, baseL: 0.65 },
            { id: 'water', name: 'Ê∞¥', cssColor: '#0091ea', baseH: 0.60, baseS: 0.90, baseL: 0.50 }
        ];

        function calculateBazi(isUserAction = false) {
            const input = document.getElementById('birth-input').value;
            if (!input) { alert("Ë´ãËº∏ÂÖ•Êó•ÊúüÔºÅ"); return; }
            const date = new Date(input);
            const solar = Solar.fromYmdHms(date.getFullYear(), date.getMonth() + 1, date.getDate(), date.getHours(), date.getMinutes(), 0);
            const bazi = solar.getLunar().getEightChar();
            
            const pillars = [
                { gan: bazi.getYearGan(), zhi: bazi.getYearZhi(), weight: 1.0 },
                { gan: bazi.getMonthGan(), zhi: bazi.getMonthZhi(), weight: 2.5 },
                { gan: bazi.getDayGan(), zhi: bazi.getDayZhi(), weight: 1.2 },
                { gan: bazi.getTimeGan(), zhi: bazi.getTimeZhi(), weight: 1.0 }
            ];

            const baziStr = pillars.map(p => p.gan + p.zhi).join(' ');
            const dayMaster = pillars[2].gan; 
            // ‰øÆÊîπÔºö‰ΩøÁî®Á¥îÊï∏Â≠óÊó•ÊúüÊ†ºÂºè
            const dateStr = `${date.getFullYear()}/${String(date.getMonth()+1).padStart(2,'0')}/${String(date.getDate()).padStart(2,'0')} ${String(date.getHours()).padStart(2,'0')}:${String(date.getMinutes()).padStart(2,'0')}`;
            const genderVal = document.querySelector('input[name="gender"]:checked').value;
            const genderText = genderVal == "1" ? "‚ôÇ" : "‚ôÄ";
            const masterElement = GAN_WUXING[dayMaster];
            const masterElementCN = ELEMENT_CN[masterElement];

            // ‰øÆÊîπÔºöÊîπÂõûÁ∞°ÊΩîÁöÑÂñÆË°åÂÖ´Â≠óÈ°ØÁ§∫
            document.getElementById('bazi-desc').innerHTML = `<strong>üîÆ ÂÖ´Â≠óÔºö</strong>${baziStr}<br><strong>üßí Êó•‰∏ªÔºö</strong>${dayMaster} (${masterElementCN}) / ${genderText}<br><span class="date-confirm">üìÖ Ë•øÊõÜÔºö${dateStr}</span>`;

            let scores = { wood: 0, fire: 0, earth: 0, metal: 0, water: 0 };
            const GAN_BASE = 15; const ZHI_BASE = 30;

            pillars.forEach(p => {
                if (GAN_WUXING[p.gan]) scores[GAN_WUXING[p.gan]] += GAN_BASE * p.weight;
                const hidden = ZHI_CANGGAN[p.zhi];
                if (hidden) {
                    for (const [el, pct] of Object.entries(hidden)) scores[el] += (ZHI_BASE * (pct / 100)) * p.weight;
                }
            });

            let total = Object.values(scores).reduce((a, b) => a + b, 0) || 1;
            currentRatios = {
                wood: scores.wood / total,
                fire: scores.fire / total,
                earth: scores.earth / total,
                metal: scores.metal / total,
                water: scores.water / total
            };
            updateSystem();

            // Ëá™ÂãïÈö±ËóèÈù¢Êùø (ÂÉÖÁï∂Áî®Êà∂ÈªûÊìäÊåâÈàïÊôÇ)
            if (isUserAction) {
                togglePanel('collapse');
            }
        }

        // --- 3. RPG Á≥ªÁµ± ---
        function calculateRPG() {
            const sorted = Object.entries(currentRatios).sort((a,b) => b[1] - a[1]);
            const mainKey = sorted[0][0]; 
            const mainVal = sorted[0][1]; 
            const subKey = sorted[1][0];  
            const subVal = sorted[1][1];

            const typeIndex = mainVal > 0.35 ? 0 : 1; 
            const mainClassData = RPG_DATA[mainKey];
            const classCategory = typeIndex === 0 ? mainClassData.mainA : mainClassData.mainB;

            let finalSubKey = subKey;
            if (mainVal > 0.5 || mainVal > subVal * 2) {
                finalSubKey = mainKey;
            }
            const branchData = mainClassData.branches[finalSubKey][typeIndex];
            
            let rarity = 'R';
            let focusScore = mainVal + (subVal * 0.5); 
            if (mainVal > 0.45) rarity = 'SSR';
            else if (mainVal > 0.35 || focusScore > 0.55) rarity = 'SR';

            const r = currentRatios;
            const calcStat = (val) => Math.min(99, Math.round(30 + val * 120)); 

            const rawSTR = r.metal * 1.0 + r.earth * 0.4 + r.fire * 0.2;
            const rawINT = r.water * 1.0 + r.fire * 0.4 + r.wood * 0.2;
            const rawAGI = r.wood * 1.0 + r.water * 0.4 + r.metal * 0.2;
            const rawVIT = r.earth * 1.0 + r.metal * 0.4 + r.wood * 0.2;
            
            const values = Object.values(r);
            const mean = values.reduce((a,b)=>a+b,0) / 5;
            const variance = values.reduce((a,b)=>a + Math.pow(b-mean, 2), 0) / 5;
            const stdDev = Math.sqrt(variance); 
            const rawLUK = 0.2 + (0.4 - stdDev); 

            const s = {
                STR: calcStat(rawSTR),
                INT: calcStat(rawINT),
                AGI: calcStat(rawAGI),
                VIT: calcStat(rawVIT),
                LUK: calcStat(rawLUK)
            };

            return {
                mainName: classCategory.name,
                mainIcon: classCategory.icon,
                jobName: branchData.n,
                jobDesc: branchData.d,
                stats: s,
                rarity: rarity,
                mainColor: RPG_DATA[mainKey].color,
                mainElement: mainKey
            };
        }

        function showRPGCard() {
            const data = calculateRPG();
            const badge = document.getElementById('rarity-badge');
            
            if (badge) {
                badge.className = `rpg-rarity-badge rarity-${data.rarity}`;
                badge.innerText = data.rarity;
            }

            const visualBg = document.getElementById('class-visual-bg');
            if (visualBg) {
                visualBg.style.background = data.mainColor;
                visualBg.innerHTML = data.mainIcon;
            }

            const elMainType = document.getElementById('rpg-main-type');
            if (elMainType) elMainType.innerText = data.mainName;
            
            const elJobName = document.getElementById('rpg-job-name');
            if (elJobName) elJobName.innerText = data.jobName;
            
            const elJobDesc = document.getElementById('rpg-job-desc');
            if (elJobDesc) elJobDesc.innerText = data.jobDesc;
            
            const s = data.stats;
            const statsHtml = `
                <div class="stat-item"><b style="color:#e74c3c">${s.STR}</b><span>STR</span></div>
                <div class="stat-item"><b style="color:#3498db">${s.INT}</b><span>INT</span></div>
                <div class="stat-item"><b style="color:#2ecc71">${s.AGI}</b><span>AGI</span></div>
                <div class="stat-item"><b style="color:#f1c40f">${s.VIT}</b><span>VIT</span></div>
                <div class="stat-item"><b style="color:#9b59b6">${s.LUK}</b><span>LUK</span></div>
            `;
            const elStatsRow = document.getElementById('stats-text-row');
            if (elStatsRow) elStatsRow.innerHTML = statsHtml;

            const canvas = document.getElementById('statsChart');
            if (canvas) {
                const ctx = canvas.getContext('2d');
                if (currentChart) currentChart.destroy();

                currentChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['STR', 'INT', 'AGI', 'VIT', 'LUK'],
                        datasets: [{
                            label: 'ËÉΩÂäõÂÄº',
                            data: [s.STR, s.INT, s.AGI, s.VIT, s.LUK],
                            backgroundColor: `${data.mainColor}33`, 
                            borderColor: data.mainColor,
                            pointBackgroundColor: '#fff',
                            pointBorderColor: '#fff',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                                grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                pointLabels: { color: '#ccc', font: { size: 12, family: 'Nunito' } },
                                ticks: { display: false, max: 100, min: 0 },
                                suggestedMax: 100
                            }
                        },
                        plugins: { legend: { display: false } }
                    }
                });
            }

            const modal = document.getElementById('rpg-modal');
            if (modal) modal.style.display = 'flex';
        }

        function closeRPGModal(e) {
            if (e.target.id === 'rpg-modal' || e.target.className.includes('close-modal')) {
                document.getElementById('rpg-modal').style.display = 'none';
            }
        }

        function toggleLegend() {
            const legend = document.getElementById('legend-container');
            const disclaimer = document.getElementById('disclaimer-text');
            const btn = document.getElementById('btn-toggle-legend');
            
            if (legend.style.display === 'block') {
                legend.style.display = 'none';
                if(disclaimer) disclaimer.style.display = 'none';
                btn.innerText = 'üìä È°ØÁ§∫Ë©≥Á¥∞Êï∏Êìö ‚ñº';
            } else {
                legend.style.display = 'block';
                if(disclaimer) disclaimer.style.display = 'block';
                btn.innerText = 'üìä Èö±ËóèË©≥Á¥∞Êï∏Êìö ‚ñ≤';
            }
        }

        // --- 4. Three.js Visuals ---
        let particleSystem, particleAttributes;
        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x1A1A2E, 0.002);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 1, 1000);
        camera.position.z = 45;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true; controls.autoRotate = true; controls.autoRotateSpeed = 0.8;

        function getSoftParticleTexture() {
            const cvs = document.createElement('canvas'); cvs.width=64; cvs.height=64;
            const ctx = cvs.getContext('2d');
            const grd = ctx.createRadialGradient(32,32,0,32,32,32);
            grd.addColorStop(0,'rgba(255,255,255,1)'); grd.addColorStop(0.15,'rgba(255,255,255,0.9)'); 
            grd.addColorStop(0.4,'rgba(255,255,255,0.3)'); grd.addColorStop(1,'rgba(0,0,0,0)');
            ctx.fillStyle = grd; ctx.fillRect(0,0,64,64);
            const tex = new THREE.Texture(cvs); tex.needsUpdate = true; return tex;
        }

        function updateSystem() {
            if (particleSystem) scene.remove(particleSystem);
            const counts = {}; let total = 0;
            elementsDef.forEach(el => {
                let c = Math.round(baseTotal * currentRatios[el.id]);
                counts[el.id] = c; total += c;
            });

            const lDiv = document.getElementById('legend-container'); lDiv.innerHTML = '';
            elementsDef.forEach(el => {
                const pct = total>0 ? (counts[el.id]/total*100).toFixed(1) : 0;
                lDiv.innerHTML += `<div class="legend-item"><div class="dot" style="background:${el.cssColor}"></div><div style="width:50px">${el.name}</div><div class="bar-container"><div class="bar" style="width:${pct}%;background:${el.cssColor}"></div></div><div class="count-text">${counts[el.id]}</div></div>`;
            });

            const geo = new THREE.BufferGeometry();
            const pos=[], col=[], siz=[], pha=[], baseSiz=[];
            const tmpCol = new THREE.Color();

            elementsDef.forEach(el => {
                for(let i=0; i<counts[el.id]; i++){
                    const r = 12 + Math.random()*14;
                    const theta = Math.random()*Math.PI*2;
                    const phi = Math.acos(2*Math.random()-1);
                    pos.push(r*Math.sin(phi)*Math.cos(theta), r*Math.sin(phi)*Math.sin(theta), r*Math.cos(phi));
                    
                    let h=el.baseH+(Math.random()-0.5)*0.06;
                    let s=Math.max(0.3, Math.min(1.0, el.baseS+(Math.random()-0.5)*0.2));
                    let l=Math.max(0.2, Math.min(0.7, el.baseL+(Math.random()-0.5)*0.2));
                    tmpCol.setHSL(h,s,l);
                    col.push(tmpCol.r, tmpCol.g, tmpCol.b);

                    const bs = 2.5+Math.random()*3.5;
                    siz.push(bs); baseSiz.push(bs); pha.push(Math.random()*Math.PI*2);
                }
            });

            geo.setAttribute('position', new THREE.Float32BufferAttribute(pos,3));
            geo.setAttribute('color', new THREE.Float32BufferAttribute(col,3));
            geo.setAttribute('size', new THREE.Float32BufferAttribute(siz,1));
            geo.setAttribute('phase', new THREE.Float32BufferAttribute(pha,1));
            geo.setAttribute('baseSize', new THREE.Float32BufferAttribute(baseSiz,1));

            const mat = new THREE.PointsMaterial({
                size: 3.0, vertexColors: true, map: getSoftParticleTexture(),
                blending: THREE.AdditiveBlending, depthWrite: false, transparent: true, opacity: 0.45, sizeAttenuation: true
            });

            particleSystem = new THREE.Points(geo, mat);
            scene.add(particleSystem);
            particleAttributes = particleSystem.geometry.attributes;
        }

        setTimeout(() => {
            if (typeof Solar !== 'undefined') {
                const now = new Date();
                const offset = now.getTimezoneOffset() * 60000;
                const localISOTime = (new Date(now - offset)).toISOString().slice(0, 16);
                document.getElementById('birth-input').value = localISOTime;
                calculateBazi();
            }
        }, 500);

        let time = 0;
        function animate() {
            requestAnimationFrame(animate);
            time += 0.02;
            if (particleSystem && particleAttributes) {
                const s = particleAttributes.size.array;
                const bs = particleAttributes.baseSize.array;
                const p = particleAttributes.phase.array;
                for(let i=0; i<s.length; i++) s[i] = Math.max(0.1, bs[i] + Math.sin(time*2.5+p[i])*4.5);
                particleAttributes.size.needsUpdate = true;
                particleSystem.rotation.y += 0.0015;
            }
            controls.update();
            renderer.render(scene, camera);
        }
        animate();
        
        // ÈüøÊáâÂºèË™øÊï¥
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            // ÊâãÊ©üÁâà: ÊÅ¢Âæ©È†êË®≠‰∏≠ÂøÉË¶ñËßí (Âõ†ÁÇ∫Èù¢ÊùøÂú®È†ÇÈÉ®ÂèØÊî∂Ëµ∑Ôºå‰∏çÊúÉÊìã‰Ωè‰∏≠Èñì)
            if (window.innerWidth <= 600) {
                camera.position.y = 0;
                camera.lookAt(0, 0, 0);
            } else {
                camera.position.y = 0;
                camera.lookAt(0, 0, 0);
            }
        }
        window.addEventListener('resize', onWindowResize);
        onWindowResize();
    </script>
</body>
</html>
